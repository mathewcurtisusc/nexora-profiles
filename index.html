<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nexora Profile</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f7;
    margin: 0;
    padding: 0;
    color: #222;
  }

  .page {
    max-width: 900px;
    margin: 40px auto;
    background: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    padding: 32px 40px;
  }

  .header {
    display: flex;
    align-items: center;
    gap: 24px;
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 24px;
    margin-bottom: 24px;
  }

  .header img {
    width: 180px;
    height: 180px;
    object-fit: cover;
    border-radius: 4px;
  }

  .title-block h1 {
    margin: 0;
    font-size: 26px;
  }

  .title-block h2 {
    margin: 4px 0 8px 0;
    font-size: 16px;
    font-weight: normal;
    color: #666;
  }

  .company {
    font-size: 13px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: #999;
  }

  .section-title {
    margin-top: 18px;
    margin-bottom: 8px;
    font-size: 14px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: #555;
  }

  p {
    line-height: 1.5;
    font-size: 14px;
    margin: 0 0 12px 0;
  }
</style>

</head>
<body>

  <div class="page">
  <div class="header">
    <img id="profile-image" alt="Profile image">
    <div class="title-block">
      <h1 id="profile-name">Loading...</h1>
      <h2 id="profile-role"></h2>
      <span class="company">Nexora</span>
    </div>
  </div>

  <section>
    <h3 class="section-title">Background</h3>
    <p id="profile-background"></p>
  </section>

  <section>
    <h3 class="section-title">Leadership Style</h3>
    <p id="profile-style"></p>
  </section>

  <section id="interests-section" style="display:none;">
    <h3 class="section-title">Personal Interests</h3>
    <p id="profile-interests"></p>
  </section>
</div>

<script>
  const SHEET_URL =
    "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2wW-ulUPyRcOy_xPMnzy0AxudKP-4RFYoZYMzTWAqMqTZvrtH1e1SiI183163SUkiGF2EM1CHlihQ/pub?output=csv";

  // Read team ID from URL, e.g. ?id=team01
  const params = new URLSearchParams(window.location.search);
  const TARGET_ID = params.get("id");

  if (!TARGET_ID) {
    document.getElementById("profile-name").innerText =
      "No team ID provided.";
    throw new Error("Missing ?id= parameter");
  }

  fetch(SHEET_URL)
    .then(response => response.text())
    .then(csv => {
      const rows = csv
        .trim()
        .split("\n")
        .map(row =>
          row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(cell =>
            cell.replace(/^"|"$/g, "").trim()
          )
        );

      const headers = rows[0];

      const idIndex = headers.indexOf("Assigned Nexora ID");
      const nameIndex = headers.indexOf("Display Name");
      const roleIndex = headers.indexOf("Role / Title");
      const backgroundIndex = headers.indexOf("Professional Background");
      const styleIndex = headers.indexOf("Leadership / Decision Style");
      const interestsIndex = headers.indexOf("Personal");
      const imageIndex = headers.indexOf("Nexora Profile Image");

      for (let i = 1; i < rows.length; i++) {
        const row = rows[i];

        if (row[idIndex] === TARGET_ID) {
          // Name
          document.getElementById("profile-name").innerText = row[nameIndex] || "";

          // Role
          document.getElementById("profile-role").innerText = row[roleIndex] || "";

          // Background
          document.getElementById("profile-background").innerText =
            row[backgroundIndex] || "";

          // Leadership style
          document.getElementById("profile-style").innerText =
            row[styleIndex] || "";

          // Personal interests (optional)
          if (row[interestsIndex]) {
            document.getElementById("profile-interests").innerText =
              row[interestsIndex];
            document.getElementById("interests-section").style.display = "block";
          }

        // Profile image (raw link from sheet â€” temporary)
const imageCell = row[imageIndex];

if (imageCell) {
  document.getElementById("profile-image").src = imageCell;
}

return;
}
}


      document.getElementById("profile-name").innerText =
        "Team not found.";
    })
    .catch(err => {
      console.error(err);
      document.getElementById("profile-name").innerText =
        "Error loading profile.";
    });
</script>

</body>
</html>
