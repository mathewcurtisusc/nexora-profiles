<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nexora Profile Test</title>
</head>
<body>

  <h1 id="profile-name">Loading...</h1>
  <p id="debug" style="font-family: monospace; color: #555;"></p>

  <script>
    const SHEET_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vS2wW-ulUPyRcOy_xPMnzy0AxudKP-4RFYoZYMzTWAqMqTZvrtH1e1SiI183163SUkiGF2EM1CHlihQ/pub?output=csv";

    const TARGET_ID = "team01"; // test ID

    const debugEl = document.getElementById("debug");
    debugEl.innerText = "Fetching CSV…";

    fetch(SHEET_URL)
      .then(response => response.text())
      .then(csv => {
        debugEl.innerText = "Parsing CSV…";

        const rows = csv
          .trim()
          .split("\n")
          .map(row => row.split(","));

        const headers = rows[0].map(h => h.trim());

        const idIndex = headers.indexOf("Assigned Nexora ID");
        const nameIndex = headers.indexOf("Display Name");

        if (idIndex === -1 || nameIndex === -1) {
          document.getElementById("profile-name").innerText =
            "Required columns not found";
          debugEl.innerText += " | Header mismatch";
          return;
        }

        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];
          if (row[idIndex] && row[idIndex].trim() === TARGET_ID) {
            document.getElementById("profile-name").innerText =
              row[nameIndex].trim();
            debugEl.innerText += " | Match found";
            return;
          }
        }

        document.getElementById("profile-name").innerText =
          "Team not found";
        debugEl.innerText += " | No match";
      })
      .catch(err => {
        document.getElementById("profile-name").innerText =
          "Error loading data";
        debugEl.innerText = "ERROR: " + err.message;
      });
  </script>

</body>
</html>
